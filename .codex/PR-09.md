# PR-09 — E2E retry/backoff test with controlled tool failures

## Goal
Validate retry logic across the real stack:
- tool or component fails N times
- runner retries according to policy
- succeeds eventually
- attempt count and error telemetry observable

## Scope
Add a deterministic “flaky tool” fixture.

## Implementation Plan
1) Add a test tool/component that:
   - fails first 2 invocations with known error
   - succeeds on 3rd
   - records attempt count in a shared place (file in artifacts dir or NATS message)
2) Scenario:
   - start flow invoking flaky tool
   - assert:
     - total attempts == 3
     - final output success
     - errors emitted for first failures
3) Ensure timing assertions are tolerant:
   - check “at least X ms between retries” if needed
   - avoid brittle exact timings

## Acceptance Criteria
- Retries work as expected.
- Observability (logs/spans or structured events) includes attempt information.
