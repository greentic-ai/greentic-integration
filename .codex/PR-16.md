# PR-16 â€” Greentic-dev E2E: flow & pack snapshot stability

## Goal
Ensure that greentic-dev generates **stable, reproducible artifacts**:
- flow definitions
- pack manifests
- pack layouts

## Scope
- Introduce snapshot testing for generated files.
- Guard against accidental CLI output or schema drift.

## Test cases to add

### 1) Flow snapshot test
- Generate a complex flow via greentic-dev.
- Insert steps (including add-step from PR-13).
- Export or read the flow definition (YAML/JSON).
- Snapshot the normalized output.
- Assert future runs match snapshot.

### 2) Pack manifest snapshot
- Generate a pack via greentic-dev.
- Snapshot:
  - `pack.yaml`
  - component references
  - version fields (excluding timestamps if needed).
- Assert stability across runs.

### 3) Deterministic ordering
- Re-run generation multiple times.
- Assert:
  - no reordering of steps/components
  - no random IDs unless explicitly expected.

## Structure
- Add snapshot helper utilities:
  - normalize paths
  - strip timestamps / machine-specific fields
- Use `insta` or equivalent snapshot framework.

## Acceptance criteria
- Snapshots fail loudly on unintended changes.
- Intentional changes require snapshot updates.
