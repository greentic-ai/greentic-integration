# PR-03 — Boot a minimal Greentic stack in E2E (runner/deployer/store) + healthchecks

## Goal
Make E2E tests exercise actual Greentic binaries:
- start minimal set of services needed to install packs + run flows
- validate they are reachable and healthy

## Scope
Start with what exists and is stable:
- greentic-runner (required)
- greentic-deployer (if needed for pack install)
- greentic-store (optional; add if pack resolution uses it)

## Implementation Plan
1) Add a `tests/bin/` convention:
   - harness can use local `target/release/<binary>` if present, else builds debug.
2) Add `ServiceProcess` wrapper:
   - spawn process with env vars
   - stream stdout/stderr to `target/e2e/<test>/logs/<service>.log`
   - kill on teardown
3) Add healthchecks per service:
   - HTTP `/health` or equivalent
   - If none exists, use “port open + stable log line” fallback
4) Wire config:
   - generate minimal config files in `target/e2e/.../config/`
   - point services to them via CLI flags or env
5) Test `tests/e2e_stack_boot.rs`:
   - `TestEnv::up_stack().await?`
   - assert service health OK

## Files
- `src/harness/services.rs`
- `src/harness/mod.rs`
- `tests/e2e_stack_boot.rs`
- docs snippet in `README.md`

## Acceptance Criteria
- Stack boots in under reasonable time and passes healthcheck.
- Logs are captured and preserved on failure.

## Routine actions pre-authorized
- Add helper scripts (e.g., `scripts/e2e.sh`) and update CI accordingly.
